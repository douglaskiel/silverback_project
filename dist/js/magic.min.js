/*
 initialserver 2017-05-09 
*/

!function(a,b,c){b.module("app",["ui.router","ngSanitize","angular.filter"]).config(["$urlRouterProvider","$stateProvider",function(a,b){b.state("index",{templateUrl:"/src/index.html",controller:"indexCtrl"}).state("home",{url:"/",templateUrl:"/src/components/home/home.html",controller:"homeCtrl"}).state("login",{url:"/login",templateUrl:"/src/components/user/views/login.html",controller:"loginCtrl"}).state("password_recovery",{url:"/password_recovery",templateUrl:"/src/components/user/views/password_recovery.html",controller:"loginCtrl"}).state("reset_password",{url:"/reset_password/:userID/:resetCode",templateUrl:"/src/components/user/views/reset_password.html",controller:"pswdCtrl"}).state("register",{url:"/register",templateUrl:"/src/components/user/views/register.html",controller:"registerCtrl"}).state("manage_users",{url:"/manage_users",templateUrl:"src/components/user/views/manage_users.html",controller:"manageUserCtrl"}).state("profile",{url:"/profile:user",templateUrl:"/src/components/user/views/profile.html",controller:"profileCtrl"}).state("company",{url:"/company",templateUrl:"/src/components/company/company.html",controller:"companyCtrl"}).state("invoice_configuration",{url:"/invoice_configuration",templateUrl:"/src/components/invoice_configuration/invoice_config.html"}).state("iot",{url:"/invoice_configuration/iot",templateUrl:"/src/components/invoice_configuration/iot/iot.html",controller:"iotCtrl"}).state("fuel_rates",{url:"/invoice_configuration/fuel_rates",templateUrl:"/src/components/invoice_configuration/fuel_rates/fuel_rates.html",controller:"fuelRatesCtrl"}).state("operational_area",{url:"/invoice_configuration/operational_area",templateUrl:"/src/components/invoice_configuration/operational_area/operational_area.html",controller:"operationalAreaCtrl"}).state("carriers",{url:"/invoice_configuration/carriers",templateUrl:"/src/components/invoice_configuration/carriers/carriers.html",controller:"carrierCtrl"}).state("accessorial_cost",{url:"/invoice_configuration/accessorial_cost",templateUrl:"/src/components/invoice_configuration/prebuilt_associated_costs/prebuilt_associated_costs.html",controller:"accessorialCtrl"}).state("fsc",{url:"/invoice_configuration/fsc",templateUrl:"/src/components/invoice_configuration/fuel_surcharge_rates/fuel_surcharge_rates.html",controller:"fscCtrl"}).state("benchmark_fsc",{url:"/invoice_configuration/benchmark_fsc",templateUrl:"/src/components/invoice_configuration/benchmark_fsc/benchmark_fsc.html",controller:"benchmarkFSCCtrl"}).state("state_region",{url:"/invoice_configuration/state_region",templateUrl:"src/components/invoice_configuration/state_regions/state_regions.html",controller:"stateRegionCtrl"}).state("list-invoice",{url:"/invoice",templateUrl:"/src/components/invoice/views/list-invoice.html",controller:"invoiceListCtrl"}).state("form-invoice",{url:"/invoice/form-invoice/:invoiceID",templateUrl:"/src/components/invoice/views/form-invoice.html",controller:"invoiceFormCtrl"}).state("view-invoice",{url:"/invoice/view-invoice/:invoiceID",templateUrl:"/src/components/invoice/views/view-invoice.html",controller:"invoiceViewCtrl"}).state("price-savings",{url:"/invoice/price-savings/:invoiceIDs/:xpoIDs",templateUrl:"/src/components/invoice/views/price-savings.html",controller:"priceSavingsCtrl"}).state("view-xpo-invoice",{url:"/invoice/view-xpo-invoice/:invoiceID",templateUrl:"/src/components/invoice/views/view-xpo-invoice.html",controller:"viewXPOInvoice"}).state("form-xpo-invoice",{url:"/invoice/form-xpo-invoice/:xpoID",templateUrl:"/src/components/invoice/views/form-invoice.html",controller:"invoiceFormCtrl"}).state("edi_test",{url:"/edi_test",templateUrl:"/src/components/edi_parse/edi_parse.html",controller:"ediCtrl"}),a.otherwise("/")}])}(window,window.angular),function(a,b,c){b.module("app").controller("companyCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.allCompanies=[];var e={headers:{"auth-token":d.token}};a.submitCompany=function(a){a.hasOwnProperty("client_address_2")?a.client_address_2=cleanEntry(a.client_address_2):a.client_address_2="",a.hasOwnProperty("client_zip_4")||(a.client_zip_4=""),a.client_address_1=cleanEntry(a.client_address_1),a.client_city=cleanEntry(a.client_city),a.client_country=cleanEntry(a.client_country),a.client_name=cleanEntry(a.client_name),a.client_id?c.put("/secure-api/company/update_company",a,e).then(function(a){console.log("Company Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/company/insert_company",a,e).then(function(a){console.log("New Company Added"),b.reload()},function(a){console.error(a)})},a.deleteCompany=function(a){!0===confirm("Are you sure you want to delete this Client?")&&(request="/secure-api/company/company_delete/?"+a,c.delete(request,e).then(function(a){console.log("Company Removed"),b.reload()},function(a){console.log(a)}))},c.get("/secure-api/company/get_companies",e).then(function(b){a.allCompanies=b.data.data;for(var c in a.allCompanies)a.allCompanies[c].client_address_1=undoCleanEntry(a.allCompanies[c].client_address_1),a.allCompanies[c].client_city=undoCleanEntry(a.allCompanies[c].client_city),a.allCompanies[c].client_name=undoCleanEntry(a.allCompanies[c].client_name),a.allCompanies[c].client_country=undoCleanEntry(a.allCompanies[c].client_country),a.allCompanies[c].client_address_2&&(a.allCompanies[c].client_address_2=undoCleanEntry(a.allCompanies[c].client_address_2))},function(a){console.log(a),b.go("login")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("homeCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.allCompanies=[];d.token}])}(window,window.angular),function(a,b,c){b.module("app").controller("indexCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.approvedUser=function(){return"Editor"===d.role||"Admin"===d.role?(a.approved=!0,!0):(a.approved=!1,!1)},a.isLoggedin=function(){return!!d.token&&(a.username=d.user,!0)},a.isAdmin=function(){return"Admin"===d.role},a.logoutConfirm=function(){!0===confirm("Are you sure you want to log out?")&&a.logout()},a.logout=function(){d.token=null,d.user=null,d.role=null,a.username=null,localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("role"),b.go("login")}}])}(window,window.angular),function(a,b,c){b.module("app").controller("invoiceFormCtrl",["$scope","$state","$http","$stateParams","userSvc",function(a,c,d,e,f){var g={headers:{"auth-token":f.token}};if(a.allInvoices=[],a.specificInvoice=[],a.allCompanies=[],a.allCarriers=[],a.allFuelRates=[],a.allIOT=[],a.allPrebuiltAccessorial=[],a.items=[],a.totalWeight=0,a.totalAccessorialCharges=0,a.invoice={},a.classOptions=[50,55,60,65,70,77.5,85,92.5,100,110,125,150,175,200,250,300,400,500],a.shippingClasses=[],a.accessorialCharges=[],a.associatedCosts=[],a.totalBenchmarkCost=[],a.allOperations=[],a.rateString="",a.returnString="",a.state=c.current,a.params=e,a.errors=!1,a.errorsArry=[],a.newRow=!1,a.params.invoiceID)d.get("/secure-api/invoice/get_invoice?"+a.params.invoiceID,g).then(function(b){a.specificInvoice=b.data.data;for(var c=0;c<a.specificInvoice.length;c++)a.specificInvoice[c].process_date=date_parse(a.specificInvoice[c].process_date),a.specificInvoice[c].ship_date=date_parse(a.specificInvoice[c].ship_date),a.specificInvoice[c].delivery_date=date_parse(a.specificInvoice[c].delivery_date),a.specificInvoice[c].billed_weight=parseFloat(a.specificInvoice[c].billed_weight),a.specificInvoice[c].total_associated_costs=parseFloat(a.specificInvoice[c].total_associated_costs),a.specificInvoice[c].classification=parseFloat(a.specificInvoice[c].classification),a.specificInvoice[c].weight=parseFloat(a.specificInvoice[c].weight),a.specificInvoice[c].gross_charge=parseFloat(a.specificInvoice[c].gross_charge),a.specificInvoice[c].absolute_min_charge=parseFloat(a.specificInvoice[c].absolute_min_charge),a.specificInvoice[c].carrier_discount=parseFloat(a.specificInvoice[c].carrier_discount),a.shippingClasses.push({weight:a.specificInvoice[c].weight,classification:a.specificInvoice[c].classification,rate:a.specificInvoice[c].rate,charge:a.specificInvoice[c].charge,invoice_number:a.specificInvoice[c].invoice_number,item_id:a.specificInvoice[c].item_id}),a.PD={},a.specificInvoice[c].invoice_number=undoCleanEntry(a.specificInvoice[c].invoice_number),a.specificInvoice[c].sender_name=undoCleanEntry(a.specificInvoice[c].sender_name),a.specificInvoice[c].sender_address_1=undoCleanEntry(a.specificInvoice[c].sender_address_1),a.specificInvoice[c].sender_city=undoCleanEntry(a.specificInvoice[c].sender_city),a.specificInvoice[c].sender_country=undoCleanEntry(a.specificInvoice[c].sender_country),a.specificInvoice[c].receiver_name=undoCleanEntry(a.specificInvoice[c].receiver_name),a.specificInvoice[c].receiver_address_1=undoCleanEntry(a.specificInvoice[c].receiver_address_1),a.specificInvoice[c].receiver_city=undoCleanEntry(a.specificInvoice[c].receiver_city),a.specificInvoice[c].receiver_country=undoCleanEntry(a.specificInvoice[c].receiver_country),a.specificInvoice[c].transportation_mode=undoCleanEntry(a.specificInvoice[c].transportation_mode),a.specificInvoice[c].package_type=undoCleanEntry(a.specificInvoice[c].package_type),a.specificInvoice[c].sender_address_2=undoCleanEntry(a.specificInvoice[c].sender_address_2),a.specificInvoice[c].receiver_address_2=undoCleanEntry(a.specificInvoice[c].receiver_address_2),a.specificInvoice[c].receiver_zip_4=undoCleanEntry(a.specificInvoice[c].receiver_zip_4),a.specificInvoice[c].receiver_zip=undoCleanEntry(a.specificInvoice[c].receiver_zip),a.specificInvoice[c].sender_zip=undoCleanEntry(a.specificInvoice[c].sender_zip),a.specificInvoice[c].sender_zip_4=undoCleanEntry(a.specificInvoice[c].sender_zip_4),a.specificInvoice[c].deficit=parseFloat(a.specificInvoice[c].deficit),a.specificInvoice[c].deficit_rate=parseFloat(a.specificInvoice[c].deficit_rate);a.invoice=a.specificInvoice[0],a.items=a.specificInvoice,d.get("/secure-api/accessorial_cost_invoice/get_associated_costs_invoice?"+a.specificInvoice[0].invoice_number,g).then(function(b){a.associatedCosts=b.data.data;for(var c=0;c<a.associatedCosts.length;c++)a.accessorialCharges.push({actual_cost:parseFloat(a.associatedCosts[c].actual_cost),benchmark_cost:parseFloat(a.associatedCosts[c].benchmark_cost),cost_code:a.associatedCosts[c].cost_code,cost_id:a.associatedCosts[c].cost_id,invoice_number:a.associatedCosts[c].invoice_number}),a.PD={}},function(a){console.log(a)})},function(a){console.log(a),c.go("login")});else if(a.params.xpoID)d.get("/secure-api/xpo/get_xpo_invoice?"+a.params.xpoID,g).then(function(b){a.xpoInvoice=b.data.data,a.xpoInvoice[0].old_cost=Math.round(100*parseFloat(a.xpoInvoice[0].old_cost))/100,a.xpoInvoice[0].old_fsc=Math.round(100*parseFloat(a.xpoInvoice[0].old_fsc))/100,a.xpoInvoice[0].old_total_cost=Math.round(100*parseFloat(a.xpoInvoice[0].old_total_cost))/100,a.xpoInvoice[0].new_cost=Math.round(100*parseFloat(a.xpoInvoice[0].new_cost))/100,a.xpoInvoice[0].new_fsc=Math.round(100*parseFloat(a.xpoInvoice[0].new_fsc))/100,a.xpoInvoice[0].new_total_cost=Math.round(100*parseFloat(a.xpoInvoice[0].new_total_cost))/100,a.xpoInvoice[0].discount_percent=sanatizePercent(a.xpoInvoice[0].discount_percent),a.xpoInvoice[0].savings=Math.round(100*parseFloat(a.xpoInvoice[0].savings))/100,a.xpoInvoice[0].base_charge=Math.round(100*parseFloat(a.xpoInvoice[0].base_charge))/100,a.xpoInvoice[0].ship_date=date_parse(a.xpoInvoice[0].ship_date),a.xpoInvoice[0].process_date=date_parse(a.xpoInvoice[0].process_date),console.log(a.xpoInvoice[0]),a.invoice=a.xpoInvoice[0]},function(a){console.log(a),c.go("login")});else{a.invoice={};var h=new Date,i=h.getDay();a.invoice.process_date=5===i?h:new Date(moment().day(5)),a.shippingClasses.push({}),a.PD={}}a.setOldCost=function(b){a.invoice.old_cost=b*(1-.829),a.invoice.new_cost=b*(1-sanatizePercent(a.invoice.discount_percent)),a.invoice.old_fsc=a.invoice.old_cost*sanatizePercent(a.invoice.fsc_percent),a.invoice.new_fsc=a.invoice.new_cost*sanatizePercent(a.invoice.fsc_percent),a.invoice.old_total_cost=a.invoice.old_cost+a.invoice.old_fsc,a.invoice.new_total_cost=a.invoice.new_cost+a.invoice.new_fsc,a.invoice.savings=a.invoice.old_total_cost-a.invoice.new_total_cost},a.submitXPOInvoice=function(b){b.old_cost=Math.round(100*parseFloat(b.old_cost))/100,b.old_fsc=Math.round(100*parseFloat(b.old_fsc))/100,b.old_total_cost=Math.round(100*parseFloat(b.old_total_cost))/100,b.new_cost=Math.round(100*parseFloat(b.new_cost))/100,b.new_fsc=Math.round(100*parseFloat(b.new_fsc))/100,b.new_total_cost=Math.round(100*parseFloat(b.new_total_cost))/100,b.discount_percent=sanatizePercent(b.discount_percent),b.savings=Math.round(100*parseFloat(b.savings))/100,console.log(b);for(var e in a.allCompanies)a.allCompanies[e].client_id===b.client_id&&(b.client_name=a.allCompanies[e].client_name);b.accelerated_charge||(b.accelerated_charge=0),a.params.xpoID?d.put("/secure-api/xpo/update_xpo_invoice",b,g).then(function(a){console.log("Invoice Updated"),c.reload()},function(a){console.log(a)}):d.post("/secure-api/xpo/insert_xpo_invoice",b,g).then(function(a){console.log("New Invoice Added"),c.reload()},function(a){console.error(a)})},a.carrierCheck=function(){var b,c,d=a.invoice.sender_state,e=a.invoice.receiver_state,f=a.invoice.sender_zip,g=a.invoice.receiver_zip,h=a.invoice.carrier_id;for(var i in a.allCarriers)a.invoice.carrier_id===a.allCarriers[i].carrier_id&&(a.invoice.carrier_name=a.allCarriers[i].carrier_name);if(h&&d&&e){for(i in a.allOperations)if(a.allOperations[i].carrier_id===h&&a.allOperations[i].states===d){if(!a.allOperations[i].zip_code||""===a.allOperations[i].zip_code){b=a.allOperations[i];break}if(a.allOperations[i].zip_code===f){b=a.allOperations[i];break}}for(i in a.allOperations)if(a.allOperations[i].carrier_id===h&&a.allOperations[i].states===e){if(a.allOperations[i].zip_code===g){c=a.allOperations[i];break}if(!a.allOperations[i].zip_code||""===a.allOperations[i].zip_code){c=a.allOperations[i];break}}b&&c&&(parseFloat(b.absolute_minimum_charge)>parseFloat(c.absolute_minimum_charge)?(a.invoice.absolute_min_charge=parseFloat(b.absolute_minimum_charge),a.invoice.carrier_discount=parseFloat(b.discount),a.invoice.accelerated_charge=parseFloat(b.accelerated_charge)):(a.invoice.absolute_min_charge=parseFloat(c.absolute_minimum_charge),a.invoice.carrier_discount=parseFloat(c.discount),a.invoice.accelerated_charge=parseFloat(c.accelerated_charge)))}},a.submitInvoice=function(b,e,f){a.errors=!1,a.errorsArry=[];var h=!1,i=!1,j=!1,k=!1;for(var l in a.allOperations)if(a.allOperations[l].states===b.sender_state&&a.allOperations[l].carrier_id===b.carrier_id&&(h=!0),a.allOperations[l].states===b.receiver_state&&a.allOperations[l].carrier_id===b.carrier_id&&(i=!0),(a.allOperations[l].zip_code==b.sender_zip&&a.allOperations[l].carrier_id===b.carrier_id||(null===a.allOperations[l].zip_code||""===a.allOperations[l].zip_code)&&a.allOperations[l].carrier_id===b.carrier_id)&&(j=!0),(a.allOperations[l].zip_code==b.receiver_zip&&a.allOperations[l].carrier_id===b.carrier_id||(null===a.allOperations[l].zip_code||""===a.allOperations[l].zip_code)&&a.allOperations[l].carrier_id===b.carrier_id)&&(k=!0),h&&i&&j&&k)break;var m=!0;if(b.accelerated_charge||(b.accelerated_charge=0),h&&i&&j&&k||(m=confirm("The carrier you selected does not appear to deleive to the selected State and Zip Code combination, would you like to continue anyway?")),m)if(a.totalWeight=0,a.totalAccessorialCharges=0,a.totalBenchmarkCost=0,e!=[]&&0!==e.length){b.hasOwnProperty("sender_address_2")||(b.sender_address_2=""),b.hasOwnProperty("sender_zip_4")||(b.sender_zip_4=""),b.hasOwnProperty("receiver_address_2")||(b.receiver_address_2=""),b.hasOwnProperty("receiver_zip_4")||(b.receiver_zip_4=""),b.invoice_number=cleanEntry(b.invoice_number),b.sender_name=cleanEntry(b.sender_name),b.sender_address_1=cleanEntry(b.sender_address_1),b.sender_city=cleanEntry(b.sender_city),b.sender_country=cleanEntry(b.sender_country),b.receiver_name=cleanEntry(b.receiver_name),b.receiver_address_1=cleanEntry(b.receiver_address_1),b.receiver_city=cleanEntry(b.receiver_city),b.receiver_country=cleanEntry(b.receiver_country),b.transportation_mode=cleanEntry(b.transportation_mode),b.package_type=cleanEntry(b.package_type),b.sender_address_2=cleanEntry(b.sender_address_2),b.receiver_address_2=cleanEntry(b.receiver_address_2),b.receiver_zip_4=cleanEntry(b.receiver_zip_4),b.receiver_zip=cleanEntry(b.receiver_zip),b.sender_zip=cleanEntry(b.sender_zip),b.sender_zip_4=cleanEntry(b.sender_zip_4),b.carrier_discount=Math.round(100*sanatizePercent(b.carrier_discount))/100,b.accelerated_service||(b.accelerated_service=!1);for(l in e)e[l].invoice_number=b.invoice_number,a.totalWeight+=parseFloat(e[l].weight);b.billed_weight=a.totalWeight;for(l in f)f[l].invoice_number=b.invoice_number,a.totalAccessorialCharges+=parseFloat(f[l].actual_cost),a.totalBenchmarkCost+=f[l].benchmark_cost;b.total_associated_costs=a.totalAccessorialCharges,b.total_benchmark=a.totalBenchmarkCost,a.rateShipment(b,function(){""===a.params.invoiceID?d.post("/secure-api/invoice/insert_invoice",{invoice:b,shippedItems:e,accessorialCharges:f},g).then(function(a){console.log("New Invoice Added"),c.reload()},function(b){console.error(b);for(var c in b.data.errors)a.errors=!0,console.log(b.data.errors[c].message),a.errorsArry.push(b.data.errors[c].message)}):d.put("/secure-api/invoice/update_invoice",{invoice:b,shippedItems:e,accessorialCharges:f},g).then(function(a){console.log("Invoice Updated"),c.reload()},function(b){a.errors=!0,console.log(b);for(var c in b.data.errors)console.log(b.data.errors[c].message),a.errorsArry.push(b.data.errors[c].message)})})}else console.log("You must have atleast one item to submit this Invoice")},a.rateShipment=function(b,c){for(var e=b.sender_zip+" "+b.receiver_zip+" ",f=1e4*b.carrier_discount,h=0;h<10;h++)e+=f;b.absolute_min_charge<100?e=e+"0"+100*b.absolute_min_charge:e+=100*b.absolute_min_charge;var i=(Math.round(1e4*b.fuel_surcharge)/100).toString();for(i=padding_right(i," ",6),e=e+i+i,e+="      ",h=0;h<10;h++)if(a.shippingClasses[h]){var j=a.shippingClasses[h].classification.toString();j.length<4&&(j=padding_right(j," ",4));var k=a.shippingClasses[h].weight.toString();k.length<6&&(k=padding_left(k,"0",6)),e+=j,e+=padding_right(k," ",19)}e=padding_right(e," ",405),e+="MARS 500       20010806",e=padding_right(e," ",500);var l={rateString:e};d.put("/secure-api/invoice/test_tcp",l,g).then(function(d){var e=d.data;for(a.returnString=e.replace(/ /g,"&nbsp;"),h=0;h<10;h++){var f=85,g=91,i=91,j=98,k=23*h;a.shippingClasses[h]&&(f+=k,g+=k,i+=k,j+=k,rate=e.slice(f,g),rate=[rate.slice(0,-2),".",rate.slice(-2)].join(""),a.shippingClasses[h].rate=parseFloat(rate),charge=e.slice(i,j),charge=[charge.slice(0,-2),".",charge.slice(-2)].join(""),a.shippingClasses[h].charge=parseFloat(charge))}var l=e.slice(318,326);l=[l.slice(0,-2),".",l.slice(-2)].join(""),a.invoice.rated_sum=parseFloat(l),a.invoice.deficit_rate=parseFloat(e.slice(342,349))/100;var m=e.slice(396,404);m=[m.slice(0,-2),".",m.slice(-2)].join(""),a.invoice.rated_total_charge=parseFloat(m),c(b)},function(b){switch(console.log(b),a.errors=!0,b.data){case"01":console.log("This tariff is not available"),a.errorsArry.push("MARS Error 01: This tariff is not available");break;case"02":console.log("Rates are not available for this date"),a.errorsArry.push("MARS Error 02: Rates are not available for this date");break;case"03":console.log("The origin ZIP Code was not found in this tariff"),a.errorsArry.push("MARS Error 03: The origin ZIP Code was not found in this tariff");break;case"04":console.log("The destination ZIP Code was not found in this tariff"),a.errorsArry.push("MARS Error 04: The destination ZIP Code was not found in this tariff");break;case"05":console.log("A rate base number was not found for this pair of ZIP Codes"),a.errorsArry.push("MARS Error 05: A rate base number was not found for this pair of ZIP Codes");break;case"06":console.log("Tariff data is missing or corrupt"),a.errorsArry.push("MARS Error 06: Tariff data is missing or corrupt");break;case"99":console.log("Internal system error"),a.errorsArry.push("MARS Error 99: Internal system error");break;default:a.errorsArry.push("We have encountered an unknown MARS related error retreiving your shipment rating"),console.log("We have encountered an unknown MARS related error retreiving your shipment rating")}})},a.autoFillClient=function(b){for(var c in a.allCompanies)b===a.allCompanies[c].client_id&&(a.invoice.sender_name=a.allCompanies[c].client_name,a.invoice.sender_address_1=a.allCompanies[c].client_address_1,a.invoice.sender_address_2=a.allCompanies[c].client_address_2,a.invoice.sender_city=a.allCompanies[c].client_city,a.invoice.sender_zip=a.allCompanies[c].client_zip,a.invoice.sender_zip_4=a.allCompanies[c].client_zip_4,a.invoice.sender_country=a.allCompanies[c].client_country,a.invoice.sender_state=a.allCompanies[c].client_state,a.invoice.client_id=a.allCompanies[c].client_id,a.invoice.sender=a.allCompanies[c].client_name,a.invoice.iot_id=117)},a.addRowItem=function(b){(b.length<10||void 0===b.length)&&(a.shippingClasses.push({weight:b.weight,classification:b.class,invoice_number:b.invoice_number}),a.PD={}),!1===a.newRow&&(a.newRow=!0)},a.addRowCharge=function(b){(b.length<12||void 0===b.length)&&(a.accessorialCharges.push({actual_cost:b.actual_cost,benchmark_cost:b.benchmark_cost,cost_code:b.cost_code,invoice_number:b.invoice_number}),a.PD={}),!1===a.newRow&&(a.newRow=!0)},a.remove=function(){var c=[],d=0;b.forEach(a.shippingClasses,function(a){a.selected||c.push(a)}),a.shippingClasses=c;for(var e in a.shippingClasses)a.shippingClasses[e].item_id||d++;var f=[];b.forEach(a.accessorialCharges,function(a){a.selected||f.push(a)}),a.accessorialCharges=f;for(e in a.accessorialCharges)a.accessorialCharges[e].cost_id||d++;a.shippingClasses.length<1&&a.addRowItem(a.shippingClasses),d<1&&(a.newRow=!1)},a.fuelChange=function(b){for(var c in a.allFuelRates)if(a.allFuelRates[c].fuel_rate_id===b){a.invoice.fuel_rate_id=a.allFuelRates[c].fuel_rate_id,a.invoice.fuel_date=a.allFuelRates[c].fuel_date,a.invoice.fuel_rate=a.allFuelRates[c].fuel_rate,a.invoice.fuel_surcharge=a.allFuelRates[c].fuel_surcharge;break}},a.autoFuelSurcharge=function(b){a.invoice.wrongDate=!1;var c,d=b.getDay(),e=moment(b);c=0===d||1===d||2===d?moment(e).day(-6):moment(e).day(1),e=new Date(c._d).toISOString().slice(0,10);for(var f in a.allFuelRates)if(a.allFuelRates[f].fuel_date=new Date(a.allFuelRates[f].fuel_date).toISOString().slice(0,10),a.allFuelRates[f].fuel_date===e){a.invoice.fuel_rate_id=a.allFuelRates[f].fuel_rate_id,a.invoice.fuel_date=a.allFuelRates[f].fuel_date,a.invoice.fuel_rate=a.allFuelRates[f].fuel_rate,a.invoice.fuel_surcharge=a.allFuelRates[f].fuel_surcharge;break}},a.deleteAccessorialCharge=function(b){var e=confirm("Are you sure you want to delete this Charge?");a.totalAccessorialCharges=0,a.totalBenchmarkCost=0;for(var f in a.accessorialCharges)a.totalAccessorialCharges+=a.accessorialCharges[f].actual_cost,a.totalBenchmarkCost+=a.accessorialCharges[f].benchmark_cost;a.totalAccessorialCharges-=b.actual_cost,a.totalBenchmarkCost-=b.benchmark_cost,!0===e&&(request="/secure-api/accessorial_cost_invoice/delete_associated_costs_invoice?"+b.cost_id+"/"+a.totalAccessorialCharges+"&"+a.totalBenchmarkCost+"|"+b.invoice_number,d.delete(request,g).then(function(a){c.reload(),console.log("Charge Removed")},function(a){console.log(a)}))},a.deleteShippingClass=function(b){var e=confirm("Are you sure you want to delete this Item?");a.totalWeight=0;for(var f in a.shippingClasses)a.totalWeight+=a.shippingClasses[f].weight;a.totalWeight-=b.weight,!0===e&&(request="/secure-api/shipping_class_invoice/delete_shipping_class_invoice?"+b.item_id+"/"+a.totalWeight+"|"+b.invoice_number,d.delete(request,g).then(function(a){c.reload(),console.log("Item Removed")},function(a){console.log(a)}))},a.changeCharge=function(b,c){for(var d in a.allPrebuiltAccessorial)if(a.allPrebuiltAccessorial[d].prebuilt_cost_id===c.prebuilt_cost_id){a.accessorialCharges[b].benchmark_cost=parseFloat(a.allPrebuiltAccessorial[d].benchmark_cost),a.accessorialCharges[b].cost_code=a.allPrebuiltAccessorial[d].cost_code;break}},d.get("/secure-api/accessorial_cost/get_prebuilt_associated_costs",g).then(function(b){a.allPrebuiltAccessorial=b.data.data},function(a){console.log(a)}),d.get("/secure-api/company/get_companies",g).then(function(b){a.allCompanies=b.data.data},function(a){console.log(a)}),d.get("/secure-api/carrier/get_carriers",g).then(function(b){a.allCarriers=b.data.data},function(a){console.log(a)}),d.get("/secure-api/iot/get_iot",g).then(function(b){a.allIOT=b.data.data},function(a){console.log(a)}),d.get("/secure-api/fuel_rates/get_fuel_rates",g).then(function(b){a.allFuelRates=b.data.data;for(var c in a.allFuelRates)a.allFuelRates[c].fuel_date=date_parse(a.allFuelRates[c].fuel_date),a.allFuelRates[c].fuel_date_display=moment(a.allFuelRates[c].fuel_date).format("YYYY/MM/DD")},function(a){console.log(a)}),d.get("/secure-api/operational_area/get_operational_area",g).then(function(b){a.allOperations=b.data.data},function(a){console.log(a)})}])}(window,window.angular),function(a,b,c){b.module("app").controller("invoiceListCtrl",["$scope","$state","$http","$stateParams","userSvc",function(a,c,d,e,f){var g={headers:{"auth-token":f.token}};a.allInvoices=[],a.to=new Date(moment().day(5)),a.from=new Date(moment().day(1)),a.selectAll=!1,a.exportToSavings=function(a,b){var d=[],e=[];for(var f in a)a[f].selected&&d.push(a[f].invoice_id);for(f in b)b[f].selected&&e.push(b[f].xpo_id);d.length+e.length>0?c.go("price-savings",{invoiceIDs:d,xpoIDs:e}):console.log("Please select at least 1 invoice.")},a.selectedAll=function(){a.selectAll?a.selectAll=!1:a.selectAll=!0,b.forEach(a.allInvoices,function(b){b.selected=a.selectAll}),b.forEach(a.allXPOInvoices,function(b){b.selected=a.selectAll})},a.check=!1,a.color="",a.rateCheck=function(a){var b=a.gross_charge!==a.rated_sum&&a.deficit!==a.deficit_rate&&"0"!==a.rated_sum&&0!==a.rated_sum,c="";return b&&(c="lightsalmon"),c},d.get("/secure-api/invoice/get_invoices_once",g).then(function(b){a.allInvoices=b.data.data;for(var c in a.allInvoices)a.allInvoices[c].process_date=date_parse(a.allInvoices[c].process_date),a.allInvoices[c].ship_date=date_parse(a.allInvoices[c].ship_date),a.allInvoices[c].delivery_date=date_parse(a.allInvoices[c].delivery_date),a.allInvoices[c].invoice_number=undoCleanEntry(a.allInvoices[c].invoice_number),a.allInvoices[c].sender_name=undoCleanEntry(a.allInvoices[c].sender_name),a.allInvoices[c].sender_address_1=undoCleanEntry(a.allInvoices[c].sender_address_1),a.allInvoices[c].sender_city=undoCleanEntry(a.allInvoices[c].sender_city),a.allInvoices[c].sender_country=undoCleanEntry(a.allInvoices[c].sender_country),a.allInvoices[c].receiver_name=undoCleanEntry(a.allInvoices[c].receiver_name),a.allInvoices[c].receiver_address_1=undoCleanEntry(a.allInvoices[c].receiver_address_1),a.allInvoices[c].receiver_city=undoCleanEntry(a.allInvoices[c].receiver_city),a.allInvoices[c].receiver_country=undoCleanEntry(a.allInvoices[c].receiver_country),a.allInvoices[c].transportation_mode=undoCleanEntry(a.allInvoices[c].transportation_mode),a.allInvoices[c].package_type=undoCleanEntry(a.allInvoices[c].package_type),a.allInvoices[c].sender_address_2=undoCleanEntry(a.allInvoices[c].sender_address_2),a.allInvoices[c].receiver_address_2=undoCleanEntry(a.allInvoices[c].receiver_address_2),a.allInvoices[c].receiver_zip_4=undoCleanEntry(a.allInvoices[c].receiver_zip_4),a.allInvoices[c].receiver_zip=undoCleanEntry(a.allInvoices[c].receiver_zip),a.allInvoices[c].sender_zip=undoCleanEntry(a.allInvoices[c].sender_zip),a.allInvoices[c].sender_zip_4=undoCleanEntry(a.allInvoices[c].sender_zip_4)},function(a){console.log(a),c.go("login")}),d.get("/secure-api/xpo/get_XPO_invoices_once",g).then(function(b){a.allXPOInvoices=b.data.data;for(var c in a.allXPOInvoices)a.allXPOInvoices[c].invoice_number=a.allXPOInvoices[c].pro_number,a.allXPOInvoices[c].ship_date=date_parse(a.allXPOInvoices[c].ship_date),a.allXPOInvoices[c].process_date=date_parse(a.allXPOInvoices[c].process_date),console.log(a.allXPOInvoices[c])},function(a){console.log(a),c.go("login")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("priceSavingsCtrl",["$scope","$state","$http","$stateParams","userSvc",function(a,b,c,d,e){var f={headers:{"auth-token":e.token}};a.exportData=function(){setTimeout(function(){var b=new Blob([document.getElementById("savings_report").innerHTML],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),c=new Blob([document.getElementById("all_data").innerHTML],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"});saveAs(b,"Savings-Report-"+a.client_name+"-"+moment().format("YYYY/DD/MM")+".xls"),saveAs(c,"All-Data-"+a.client_name+"-"+moment().format("YYYY/DD/MM")+".xls")},500)},a.savingsInvoices=[],a.associatedCosts=[],a.totalBenchmarkFrieghtCharge=0,a.totalBenchmarkCharge=0,a.totalBenchmarkAccessorial=0,a.totalFuelBenchmark=0,a.totalCharged=0,a.totalAccesorialCharge=0,a.totalFreightCharge=0,a.totalFuelCharge=0,a.state=b.current,a.params=d,a.recalculation=function(b){a.totalFuelBenchmark=0,a.totalBenchmarkAccessorial=0,a.totalBenchmarkFrieghtCharge=0,a.totalBenchmarkCharge=0,a.totalAccesorialCharge=0,a.totalCharged=0,a.totalFreightCharge=0,a.totalFuelCharge=0;for(var c in a.savingsInvoices)a.savingsInvoices[c].invoice_id===b.invoice_id&&(a.savingsInvoices[c]=b,a.savingsInvoices[c].total_benchmark!==b.benchamrk_access&&null!==a.savingsInvoices[c].benchamrk_access&&(a.savingsInvoices[c].benchmark_charge+=parseFloat(b.benchamrk_access)-parseFloat(a.savingsInvoices[c].total_benchmark),a.savingsInvoices[c].total_benchmark=b.benchamrk_access),a.savingsInvoices[c].assess_charge!==b.total_associated_costs&&null!==a.savingsInvoices[c].assess_charge&&(a.savingsInvoices[c].savings_total_charge+=parseFloat(b.assess_charge)-parseFloat(a.savingsInvoices[c].total_associated_costs),a.savingsInvoices[c].total_associated_costs=b.assess_charge)),a.totalFuelBenchmark+=a.savingsInvoices[c].benchmark_fuel_charge,a.totalBenchmarkAccessorial+=parseFloat(a.savingsInvoices[c].total_benchmark),a.totalBenchmarkFrieghtCharge+=a.savingsInvoices[c].freight_charge,a.totalBenchmarkCharge+=a.savingsInvoices[c].benchmark_charge,a.totalAccesorialCharge+=parseFloat(a.savingsInvoices[c].total_associated_costs),a.totalCharged+=a.savingsInvoices[c].savings_total_charge,a.totalFreightCharge+=a.savingsInvoices[c].savings_frieght_charge,a.totalFuelCharge+=parseFloat(a.savingsInvoices[c].savings_fuel_surcharge)},a.calculation=function(){a.totalFuelBenchmark=0,a.totalBenchmarkAccessorial=0,a.totalBenchmarkFrieghtCharge=0,a.totalBenchmarkCharge=0,a.totalAccesorialCharge=0,a.totalCharged=0,a.totalFreightCharge=0,a.totalFuelCharge=0;for(var b=0;b<a.savingsInvoices.length;b++)a.savingsInvoices[b].carrier_discount=Math.round(100*a.savingsInvoices[b].carrier_discount),a.savingsInvoices[b].discount=Math.round(1e4*a.savingsInvoices[b].discount)/100,a.savingsInvoices[b].gross_charge=parseFloat(a.savingsInvoices[b].gross_charge),a.savingsInvoices[b].absolute_min_charge=parseFloat(a.savingsInvoices[b].absolute_min_charge),a.savingsInvoices[b].fsc_factor=Math.round(1e4*a.savingsInvoices[b].fsc_factor)/100,a.savingsInvoices[b].bmfsc_factor=a.savingsInvoices[b].fsc_factor+"%",a.savingsInvoices[b].fuel_surcharge=Math.round(1e4*a.savingsInvoices[b].fuel_surcharge)/100,a.savingsInvoices[b].benchmark_fuel_surcharge=Math.round(1e4*a.savingsInvoices[b].benchmark_fuel_surcharge)/100,a.savingsInvoices[b].bfsc_percent=a.savingsInvoices[b].benchmark_fuel_surcharge+"%",a.savingsInvoices[b].accelerated_charge=parseFloat(a.savingsInvoices[b].accelerated_charge),a.savingsInvoices[b].deficit=parseFloat(a.savingsInvoices[b].deficit),
a.savingsInvoices[b].gross_charge*(100-a.savingsInvoices[b].discount)/100<=88.39?(a.savingsInvoices[b].freight_charge=88.39,a.savingsInvoices[b].bmdiscount="AMC"):(a.savingsInvoices[b].bmdiscount=a.savingsInvoices[b].discount+"%",a.savingsInvoices[b].freight_charge=Math.round((a.savingsInvoices[b].gross_charge+a.savingsInvoices[b].deficit)*(100-a.savingsInvoices[b].discount))/100),a.savingsInvoices[b].benchmark_fuel_charge=Math.round(a.savingsInvoices[b].benchmark_fuel_surcharge/100*a.savingsInvoices[b].fsc_factor/100*a.savingsInvoices[b].freight_charge*100)/100,a.savingsInvoices[b].gross_charge*(100-a.savingsInvoices[b].carrier_discount)/100<=a.savingsInvoices[b].absolute_min_charge?(a.savingsInvoices[b].savings_discount="AMC",a.savingsInvoices[b].savings_frieght_charge=a.savingsInvoices[b].absolute_min_charge):(a.savingsInvoices[b].savings_discount=a.savingsInvoices[b].carrier_discount+"%",a.savingsInvoices[b].savings_frieght_charge=Math.round((a.savingsInvoices[b].gross_charge+a.savingsInvoices[b].deficit)*(100-a.savingsInvoices[b].carrier_discount))/100),a.savingsInvoices[b].savings_fuel_surcharge=Math.round(a.savingsInvoices[b].savings_frieght_charge*(a.savingsInvoices[b].fuel_surcharge/100)*100)/100,!0===a.savingsInvoices[b].accelerated_service?(a.savingsInvoices[b].savings_accelerated_charge=Math.round(a.savingsInvoices[b].savings_frieght_charge*a.savingsInvoices[b].accelerated_charge*100)/100,a.savingsInvoices[b].benchmark_accelerated_charge=Math.round(a.savingsInvoices[b].freight_charge*a.savingsInvoices[b].accelerated_charge*100)/100,a.savingsInvoices[b].savings_accelerated_charge<30&&(a.savingsInvoices[b].savings_accelerated_charge=30,a.savingsInvoices[b].benchmark_accelerated_charge<a.savingsInvoices[b].savings_accelerated_charge&&(a.savingsInvoices[b].benchmark_accelerated_charge=a.savingsInvoices[b].savings_accelerated_charge)),a.savingsInvoices[b].total_associated_costs=parseFloat(a.savingsInvoices[b].total_associated_costs)+a.savingsInvoices[b].savings_accelerated_charge,a.savingsInvoices[b].total_benchmark=parseFloat(a.savingsInvoices[b].total_benchmark)+a.savingsInvoices[b].benchmark_accelerated_charge):(a.savingsInvoices[b].savings_accelerated_charge=0,a.savingsInvoices[b].benchmark_accelerated_charge=0,a.savingsInvoices[b].total_associated_costs=parseFloat(a.savingsInvoices[b].total_associated_costs),a.savingsInvoices[b].total_benchmark=parseFloat(a.savingsInvoices[b].total_benchmark)),a.savingsInvoices[b].savings_total_charge=Math.round(100*(parseFloat(a.savingsInvoices[b].savings_frieght_charge)+parseFloat(a.savingsInvoices[b].savings_fuel_surcharge)+parseFloat(a.savingsInvoices[b].total_associated_costs)))/100,a.savingsInvoices[b].benchmark_charge=a.savingsInvoices[b].benchmark_fuel_charge+a.savingsInvoices[b].freight_charge+a.savingsInvoices[b].total_benchmark,a.totalFuelBenchmark+=a.savingsInvoices[b].benchmark_fuel_charge,a.totalBenchmarkAccessorial+=parseFloat(a.savingsInvoices[b].total_benchmark),a.totalBenchmarkFrieghtCharge+=a.savingsInvoices[b].freight_charge,a.totalBenchmarkCharge+=a.savingsInvoices[b].benchmark_charge,a.totalAccesorialCharge+=parseFloat(a.savingsInvoices[b].total_associated_costs),a.totalCharged+=a.savingsInvoices[b].savings_total_charge,a.totalFreightCharge+=a.savingsInvoices[b].savings_frieght_charge,a.totalFuelCharge+=parseFloat(a.savingsInvoices[b].savings_fuel_surcharge);for(b in a.savingsXPOInvoices)a.totalBenchmarkFrieghtCharge+=parseFloat(a.savingsXPOInvoices[b].old_cost),a.totalFuelBenchmark+=parseFloat(a.savingsXPOInvoices[b].old_fsc),a.totalBenchmarkCharge+=parseFloat(a.savingsXPOInvoices[b].old_total_cost),a.totalFreightCharge+=parseFloat(a.savingsXPOInvoices[b].new_cost),a.totalFuelCharge+=parseFloat(a.savingsXPOInvoices[b].new_fsc),a.totalCharged+=parseFloat(a.savingsXPOInvoices[b].new_total_cost)},a.params.invoiceIDs?c.get("/secure-api/invoice/get_invoices_price_savings?"+a.params.invoiceIDs,f).then(function(b){a.savingsInvoices=b.data.data;for(var d in a.savingsInvoices)a.savingsInvoices[d].carrier_name=undoCleanEntry(a.savingsInvoices[d].carrier_name),a.savingsInvoices[d].invoice_number=undoCleanEntry(a.savingsInvoices[d].invoice_number),a.savingsInvoices[d].receiver_name=undoCleanEntry(a.savingsInvoices[d].receiver_name),a.savingsInvoices[d].receiver_zip=undoCleanEntry(a.savingsInvoices[d].receiver_zip),a.savingsInvoices[d].process_date=date_parse(a.savingsInvoices[d].process_date),a.savingsInvoices[d].ship_date=date_parse(a.savingsInvoices[d].ship_date),a.savingsInvoices[d].delivery_date=date_parse(a.savingsInvoices[d].delivery_date),a.savingsInvoices[d].ACCSCosts=[],a.savingsInvoices[d].shipped_Item=[];a.process_date=a.savingsInvoices[0].process_date,a.client_name=a.savingsInvoices[0].client_name,a.params.xpoIDs?c.get("/secure-api/xpo/get_xpo_invoices_price_savings?"+a.params.xpoIDs,f).then(function(b){a.savingsXPOInvoices=b.data.data;for(d in a.savingsXPOInvoices)a.savingsXPOInvoices[d].ship_date=date_parse(a.savingsXPOInvoices[d].ship_date),a.savingsXPOInvoices[d].process_date=date_parse(a.savingsXPOInvoices[d].process_date),a.savingsXPOInvoices[d].invoice_number=a.savingsXPOInvoices[d].pro_number;a.calculation()},function(a){console.log(a)}):a.calculation()},function(a){console.log(a)}):c.get("/secure-api/xpo/get_xpo_invoices_price_savings?"+a.params.xpoIDs,f).then(function(b){a.savingsXPOInvoices=b.data.data;for(var c in a.savingsXPOInvoices)a.savingsXPOInvoices[c].ship_date=date_parse(a.savingsXPOInvoices[c].ship_date),a.savingsXPOInvoices[c].process_date=date_parse(a.savingsXPOInvoices[c].process_date),a.savingsXPOInvoices[c].invoice_number=a.savingsXPOInvoices[c].pro_number;a.process_date=a.savingsXPOInvoices[0].process_date,a.client_name=a.savingsXPOInvoices[0].client_name,a.calculation()},function(a){console.log(a)}),c.get("/secure-api/accessorial_cost_invoice/get_associated_costs_invoices",f).then(function(b){a.ACCSCosts=b.data.data;for(var c in a.ACCSCosts){a.ACCSCosts[c].invoice_number=undoCleanEntry(a.ACCSCosts[c].invoice_number);for(var d in a.savingsInvoices)a.ACCSCosts[c].invoice_number===a.savingsInvoices[d].invoice_number&&a.savingsInvoices[d].ACCSCosts.push(a.ACCSCosts[c])}},function(a){console.log(a)}),c.get("/secure-api/shipping_class_invoice/get_shipping_class_invoice",f).then(function(b){a.shipped_Item=b.data.data;for(var c in a.shipped_Item){a.shipped_Item[c].invoice_number=undoCleanEntry(a.shipped_Item[c].invoice_number);for(var d in a.savingsInvoices)a.shipped_Item[c].invoice_number===a.savingsInvoices[d].invoice_number&&a.savingsInvoices[d].shipped_Item.push(a.shipped_Item[c])}},function(a){console.log(a),b.go("login")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("invoiceViewCtrl",["$scope","$state","$http","$stateParams","userSvc",function(a,b,c,d,e){var f={headers:{"auth-token":e.token}};a.specificInvoice=[],a.associatedCosts=[],a.state=b.current,a.params=d,c.get("/secure-api/invoice/get_invoice?"+a.params.invoiceID,f).then(function(b){a.specificInvoice=b.data.data;for(var d=0;d<a.specificInvoice.length;d++)a.specificInvoice[d].process_date=date_parse(a.specificInvoice[d].process_date),a.specificInvoice[d].ship_date=date_parse(a.specificInvoice[d].ship_date),a.specificInvoice[d].delivery_date=date_parse(a.specificInvoice[d].delivery_date),a.specificInvoice[d].carrier_discount=Math.round(100*a.specificInvoice[d].carrier_discount),a.specificInvoice[d].invoice_number=undoCleanEntry(a.specificInvoice[d].invoice_number),a.specificInvoice[d].sender_name=undoCleanEntry(a.specificInvoice[d].sender_name),a.specificInvoice[d].sender_address_1=undoCleanEntry(a.specificInvoice[d].sender_address_1),a.specificInvoice[d].sender_city=undoCleanEntry(a.specificInvoice[d].sender_city),a.specificInvoice[d].sender_country=undoCleanEntry(a.specificInvoice[d].sender_country),a.specificInvoice[d].receiver_name=undoCleanEntry(a.specificInvoice[d].receiver_name),a.specificInvoice[d].receiver_address_1=undoCleanEntry(a.specificInvoice[d].receiver_address_1),a.specificInvoice[d].receiver_city=undoCleanEntry(a.specificInvoice[d].receiver_city),a.specificInvoice[d].receiver_country=undoCleanEntry(a.specificInvoice[d].receiver_country),a.specificInvoice[d].transportation_mode=undoCleanEntry(a.specificInvoice[d].transportation_mode),a.specificInvoice[d].package_type=undoCleanEntry(a.specificInvoice[d].package_type),a.specificInvoice[d].sender_address_2=undoCleanEntry(a.specificInvoice[d].sender_address_2),a.specificInvoice[d].receiver_address_2=undoCleanEntry(a.specificInvoice[d].receiver_address_2),a.specificInvoice[d].receiver_zip_4=undoCleanEntry(a.specificInvoice[d].receiver_zip_4),a.specificInvoice[d].receiver_zip=undoCleanEntry(a.specificInvoice[d].receiver_zip),a.specificInvoice[d].sender_zip=undoCleanEntry(a.specificInvoice[d].sender_zip),a.specificInvoice[d].sender_zip_4=undoCleanEntry(a.specificInvoice[d].sender_zip_4);a.items=a.specificInvoice,c.get("/secure-api/accessorial_cost_invoice/get_associated_costs_invoice?"+a.specificInvoice[0].invoice_number,f).then(function(b){a.associatedCosts=b.data.data},function(a){console.log(a)})},function(a){console.log(a),b.go("login")}),a.deleteInvoice=function(a){!0===confirm("Are you sure you want to delete this Invoice?")&&(request="/secure-api/invoice/delete_invoice?"+a,c.delete(request,f).then(function(a){console.log("Invoice Removed"),b.go("list-invoice")},function(a){console.log(a),b.go("login")}))}}])}(window,window.angular),function(a,b,c){b.module("app").controller("viewXPOInvoice",["$scope","$state","$http","$stateParams","userSvc",function(a,b,c,d,e){var f={headers:{"auth-token":e.token}};a.state=b.current,a.params=d,a.xpoInvoice={},a.deleteXPOInvoice=function(a){!0===confirm("Are you sure you want to delete this Invoice?")&&(request="/secure-api/xpo/delete_xpo_invoice?"+a,c.delete(request,f).then(function(a){console.log("Invoice Removed"),b.go("list-invoice")},function(a){console.log(a),b.go("login")}))},c.get("/secure-api/xpo/get_xpo_invoice?"+a.params.invoiceID,f).then(function(b){a.xpoInvoice=b.data.data,a.xpoInvoice[0].ship_date=date_parse(a.xpoInvoice[0].ship_date),a.xpoInvoice[0].process_date=date_parse(a.xpoInvoice[0].process_date)},function(a){console.log(a),b.go("login")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("iotCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.allIOT=[],a.submitIOT=function(a){a.delivery_type=cleanEntry(a.delivery_type),a.discount=sanatizePercent(a.discount),a.fsc_factor=sanatizePercent(a.fsc_factor),a.iot_id?c.put("/secure-api/iot/update_iot",a,e).then(function(a){console.log("IOT Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/iot/insert_IOT",a,e).then(function(a){console.log("IOT Added"),b.reload()},function(a){console.error(a)})},a.deleteIOT=function(a){confirm("Are you sure you want to delete this IOT?")&&(request="/secure-api/iot/delete_iot/?"+a,c.delete(request,e).then(function(a){console.log("IOT Removed"),b.reload()},function(a){console.log(a)}))},c.get("/secure-api/iot/get_iot",e).then(function(b){a.allIOT=b.data.data;for(var c in a.allIOT)a.allIOT[c].delivery_type=cleanEntry(a.allIOT[c].delivery_type)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("benchmarkFSCCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.benchmark_fscs=[],a.submitBenchmarkFSC=function(d){var f=!1;for(var g in a.benchmark_fscs)if(a.benchmark_fscs[g].fuel_index===d.fuel_index&&d.benchmark_fsc_id!==a.benchmark_fscs[g].benchmark_fsc_id){console.log("That rate is already covered please enter a diffrent rate"),f=!0;break}f||(d.benchmark_fuel_surcharge=sanatizePercent(d.benchmark_fuel_surcharge),d.benchmark_fsc_id?c.put("/secure-api/benchmark_fsc/update_benchmark_fsc",d,e).then(function(a){console.log("FSC Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/benchmark_fsc/insert_benchmark_fsc",d,e).then(function(a){console.log("FSC Added"),b.reload()},function(a){console.error(a)}))},a.deleteBenchmarkFSC=function(a){request="/secure-api/benchmark_fsc/delete_benchmark_fsc/?"+a,c.delete(request,e).then(function(a){console.log("FSC Removed"),b.reload()},function(a){console.log(a)})},c.get("/secure-api/benchmark_fsc/get_benchmark_fsc",e).then(function(b){a.benchmark_fscs=b.data.data;for(var c in a.benchmark_fscs)a.benchmark_fscs[c].benchmark_fuel_surcharge_percent=Math.round(1e4*a.benchmark_fscs[c].benchmark_fuel_surcharge)/100+"%",a.benchmark_fscs[c].fuel_index=parseFloat(a.benchmark_fscs[c].fuel_index),a.benchmark_fscs[c].benchmark_fuel_surcharge=parseFloat(a.benchmark_fscs[c].benchmark_fuel_surcharge)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("carrierCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.allCarriers=[];var e={headers:{"auth-token":d.token}};a.submitCarrier=function(a){a.carrier_name=cleanEntry(a.carrier_name),a.carrier_id?c.put("/secure-api/carrier/update_carrier",a,e).then(function(a){console.log("Carrier Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/carrier/insert_carriers",a,e).then(function(a){console.log("New Carrier Added"),b.reload()},function(a){console.error(a)})},a.deleteCarrier=function(a){confirm("Are you sure you want to delete this Carrier?")&&(request="/secure-api/carrier/delete_carrier/?"+a,c.delete(request,e).then(function(a){console.log("Carrier Removed"),b.reload()},function(a){console.log(a)}))},c.get("/secure-api/carrier/get_carriers",e).then(function(b){a.allCarriers=b.data.data;for(var c in a.allCarriers)a.allCarriers[c].carrier_name=undoCleanEntry(a.allCarriers[c].carrier_name)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("fuelRatesCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.allFuelRates=[],a.fscs=[],a.benchmark_fscs=[],a.limit=100,a.submitFuelRate=function(d){d.fuel_rate_rounded=Math.floor(100*d.fuel_rate);for(var f in a.benchmark_fscs)d.fuel_rate_rounded===a.benchmark_fscs[f].fuel_index&&(d.benchmark_fuel_surcharge=a.benchmark_fscs[f].benchmark_fuel_surcharge);if(d.benchmark_fuel_surcharge||(d.benchmark_fuel_surcharge=null),d.fuel_rate<2)d.fuel_surcharge=0;else for(var g in a.fscs)a.fscs[g].start_rate<=d.fuel_rate&&d.fuel_rate<=a.fscs[g].end_rate&&(d.fuel_surcharge=a.fscs[g].fuel_surcharge);d.fuel_rate_id?c.put("/secure-api/fuel_rates/update_fuel_rate",d,e).then(function(a){console.log("Fuel Rate Updated")},function(a){console.log(a)}):c.post("/secure-api/fuel_rates/insert_fuel_rate",d,e).then(function(a){console.log("Fuel Rate Added"),b.reload()},function(a){console.error(a)})},a.deleteFuelRate=function(a){request="/secure-api/fuel_rates/delete_fuel_rate/?"+a,c.delete(request,e).then(function(a){console.log("Fuel Rate Removed"),b.reload()},function(a){console.log(a)})},a.sortBy=function(b){a.reverse=null!==b&&a.propertyName===b&&!a.reverse,a.propertyName=b},c.get("/secure-api/fuel_rates/get_fuel_rates",e).then(function(b){a.allFuelRates=b.data.data;for(var c=0;c<a.allFuelRates.length;c++)a.allFuelRates[c].fuel_date=date_parse(a.allFuelRates[c].fuel_date)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/fuel_surcharge_rates/get_fsc",e).then(function(b){a.fscs=b.data.data;for(var c in a.fscs)a.fscs[c].fuel_surcharge_percent=Math.round(1e4*a.fscs[c].fuel_surcharge)/100+"%",a.fscs[c].start_rate=parseFloat(a.fscs[c].start_rate),a.fscs[c].end_rate=parseFloat(a.fscs[c].end_rate),a.fscs[c].fuel_surcharge=parseFloat(a.fscs[c].fuel_surcharge)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/benchmark_fsc/get_benchmark_fsc",e).then(function(b){a.benchmark_fscs=b.data.data;for(var c in a.benchmark_fscs)a.benchmark_fscs[c].benchmark_fuel_surcharge_percent=Math.round(1e4*a.benchmark_fscs[c].benchmark_fuel_surcharge)/100+"%",a.benchmark_fscs[c].fuel_index=parseFloat(a.benchmark_fscs[c].fuel_index),a.benchmark_fscs[c].benchmark_fuel_surcharge=parseFloat(a.benchmark_fscs[c].benchmark_fuel_surcharge)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),a.increaseLimit=function(){a.limit+=100,console.log(a.limit)}}])}(window,window.angular),function(a,b,c){b.module("app").controller("fscCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.fscs=[],a.submitFSC=function(d){var f=!1;if(d.start_rate<d.end_rate){for(var g in a.fscs)if(a.fscs[g].start_rate<=d.start_rate&&a.fscs[g].end_rate>=d.start_rate&&d.fuel_surcharge_id!==a.fscs[g].fuel_surcharge_id){console.log("That rate is already covered please enter a diffrent rate"),f=!0;break}f||(d.fuel_surcharge=sanatizePercent(d.fuel_surcharge),d.fuel_surcharge_id?c.put("/secure-api/fuel_surcharge_rates/update_fsc",d,e).then(function(a){console.log("FSC Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/fuel_surcharge_rates/insert_fsc",d,e).then(function(a){console.log("FSC Added"),b.reload()},function(a){console.error(a)}))}else console.log("Starting Rate must be lower than ending rate")},a.deleteFSC=function(a){request="/secure-api/fuel_surcharge_rates/delete_fsc/?"+a,c.delete(request,e).then(function(a){console.log("FSC Removed"),b.reload()},function(a){console.log(a)})},c.get("/secure-api/fuel_surcharge_rates/get_fsc",e).then(function(b){a.fscs=b.data.data;for(var c in a.fscs)a.fscs[c].fuel_surcharge_percent=Math.round(1e4*a.fscs[c].fuel_surcharge)/100+"%",a.fscs[c].start_rate=parseFloat(a.fscs[c].start_rate),a.fscs[c].end_rate=parseFloat(a.fscs[c].end_rate),a.fscs[c].fuel_surcharge=parseFloat(a.fscs[c].fuel_surcharge)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("operationalAreaCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.allOperations=[],a.allCarriers=[],a.limit=100;var e={headers:{"auth-token":d.token}};a.submitOperationalArea=function(d){for(var f in a.allStates)a.allStates[f].state_id===d.state_id&&(d.states=a.allStates[f].states);d.accelerated_charge||(d.accelerated_charge=0),void 0!==d.zip_code&&""!==d.zip_code&&null!==d.zip_code||(d.zip_code=""),d.zip_code=cleanEntry(d.zip_code),d.discount=sanatizePercent(d.discount),d.accelerated_charge=sanatizePercent(d.accelerated_charge),d.operation_id?c.put("/secure-api/operational_area/update_operational_area",d,e).then(function(a){console.log("Operational Area  Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/operational_area/insert_operational_area",d,e).then(function(a){console.log("Operational Area Added"),b.reload()},function(a){console.error(a)})},a.massUpdate=function(a){a.discount=sanatizePercent(a.discount),a.accelerated_charge=sanatizePercent(a.accelerated_charge),c.put("/secure-api/operational_area/update_operational_region",a,e).then(function(a){console.log("Operational Area  Updated"),b.reload()},function(a){console.log(a)})},a.deleteOperationalArea=function(a){request="/secure-api/operational_area/delete_operational_area/?"+a,c.delete(request,e).then(function(a){console.log("Operational Area Removed"),b.reload()},function(a){console.log(a)})},a.sortBy=function(b){a.reverse=null!==b&&a.propertyName===b&&!a.reverse,a.propertyName=b},a.update_list=function(b){a.selectedRegion=[];for(var c in a.allRegions)a.allRegions[c].state_id===b&&a.selectedRegion.push(a.allRegions[c])},c.get("/secure-api/operational_area/get_operational_area",e).then(function(b){a.allOperations=b.data.data;for(var c=0;c<a.allOperations.length;c++)a.allOperations[c].absolute_minimum_charge=parseFloat(a.allOperations[c].absolute_minimum_charge),a.allOperations[c].accelerated_charge&&(a.allOperations[c].accelerated_charge=parseFloat(a.allOperations[c].accelerated_charge)),a.allOperations[c].zip_code&&(a.allOperations[c].zip_code=undoCleanEntry(a.allOperations[c].zip_code)),a.allOperations[c].region=undoCleanEntry(a.allOperations[c].region)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/region/get_region",e).then(function(b){a.allRegions=b.data.data;for(var c in a.allRegions)a.allRegions[c].region=undoCleanEntry(a.allRegions[c].region);a.updateRegions=a.allRegions,a.selectedRegion=a.allRegions,a.updateRegions.push({region:"ALL REGIONS",state_region_id:"*"})},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/states/get_state",e).then(function(b){a.allStates=b.data.data;for(var c in a.allStates)a.allStates[c].states=undoCleanEntry(a.allStates[c].states)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/carrier/get_carriers",e).then(function(b){a.allCarriers=b.data.data;for(var c in a.allCarriers)a.allCarriers[c].carrier_name=undoCleanEntry(a.allCarriers[c].carrier_name)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),a.increaseLimit=function(){a.limit+=100,console.log(a.limit)}}])}(window,window.angular),function(a,b,c){b.module("app").controller("accessorialCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.allAccessorial=[];var e={headers:{"auth-token":d.token}};a.submitAccessorialCharge=function(a){a.description=cleanEntry(a.description),a.cost_code=cleanEntry(a.cost_code),a.prebuilt_cost_id?c.put("/secure-api/accessorial_cost/update_prebuilt_associated_costs",a,e).then(function(a){console.log("Operational Area Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/accessorial_cost/insert_prebuilt_associated_costs",a,e).then(function(a){console.log("Operational Area Added"),b.reload()},function(a){console.log(a)})},a.deleteAccessorialCharge=function(a){request="/secure-api/accessorial_cost/delete_prebuilt_associated_costs/?"+a,c.delete(request,e).then(function(a){console.log("Operational Area Removed"),b.reload()},function(a){console.log(a)})},c.get("/secure-api/accessorial_cost/get_prebuilt_associated_costs",e).then(function(b){a.allAccessorial=b.data.data;for(var c in a.allAccessorial)a.allAccessorial[c].benchmark_cost=parseFloat(a.allAccessorial[c].benchmark_cost),a.allAccessorial[c].description=undoCleanEntry(a.allAccessorial[c].description),a.allAccessorial[c].cost_code=undoCleanEntry(a.allAccessorial[c].cost_code)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("stateRegionCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.allRegions=[],a.submitRegion=function(a){a.region=cleanEntry(a.region),a.state_region_id?c.put("/secure-api/region/update_region",a,e).then(function(a){console.log("Region Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/region/insert_region",a,e).then(function(a){console.log("IOT Added"),b.reload()},function(a){console.error(a)})},a.deleteRegion=function(a){confirm("Are you sure you want to delete this Region?")&&(request="/secure-api/region/delete_region/?"+a,c.delete(request,e).then(function(a){console.log("Region Removed"),b.reload()},function(a){console.log(a)}))},a.submitState=function(a){a.states=cleanEntry(a.states),a.state_region_id?c.put("/secure-api/states/update_state",a,e).then(function(a){console.log("State Updated"),b.reload()},function(a){console.log(a)}):c.post("/secure-api/states/insert_state",a,e).then(function(a){console.log("State Added"),b.reload()},function(a){console.error(a)})},a.deleteState=function(a){confirm("Are you sure you want to delete this State?")&&(request="/secure-api/states/delete_state/?"+a,c.delete(request,e).then(function(a){console.log("Region Removed"),b.reload()},function(a){console.log(a)}))},c.get("/secure-api/states/get_state",e).then(function(b){a.allStates=b.data.data},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/region/get_region",e).then(function(b){a.allRegions=b.data.data;for(var c in a.allRegions)a.allRegions[c].region=undoCleanEntry(a.allRegions[c].region)},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").service("userSvc",[function(){var a=this;a.token=void 0,a.user=void 0,a.role=void 0;var b,c=localStorage.getItem("token"),d=localStorage.getItem("user");'"Admin"'!==localStorage.getItem("role")&&'"Editor"'!==localStorage.getItem("role")||(b=localStorage.getItem("role")),c&&(a.token=JSON.parse(c),a.user=JSON.parse(d),'"Admin"'!==b&&'"Editor"'!==b||(a.role=JSON.parse(b))),date_parse=function(a){return a=a.toString(),a=moment.utc(a).add("12","hours").format(),a=moment.utc(a).toDate()},padding_right=function(a,b,c){if(!a||!b||a.length>=c)return a;for(var d=(c-a.length)/b.length,e=0;e<d;e++)a+=b;return a},padding_left=function(a,b,c){if(!a||!b||a.length>=c)return a;for(var d=(c-a.length)/b.length,e=0;e<d;e++)a=b+a;return a},cleanEntry=function(a){return a.replace(/~/g,"&tilde;").replace(/`/g,"&grave;").replace(/!/g,"&excl;").replace(/@/g,"&commat;").replace(/#/g,"&num;").replace(/\$/g,"&dollar;").replace(/%/g,"&percnt;").replace(/\^/g,"&Hat;").replace(/\*/g,"&ast;").replace(/\(/g,"&lpar;").replace(/\)/g,"&rpar;").replace(/-/g,"&hyphen;").replace(/_/g,"&lowbar;").replace(/\+/g,"&plus;").replace(/=/g,"&equals;").replace(/{/g,"&lbrace;").replace(/}/g,"&rbrace;").replace(/]/g,"&rbrack;").replace(/\[/g,"&lbrack;").replace(/:/g,"&colon;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/,/g,"&comma;").replace(/</g,"&lt;").replace(/\./g,"&period;").replace(/>/g,"&gt;").replace(/\?/g,"&quest;").replace(/\//g,"&sol;").replace(/\|/g,"&vert;")},undoCleanEntry=function(a){return a.replace(/&tilde;/g,"~").replace(/&grave;/g,"`").replace(/&excl;/g,"!").replace(/&commat;/g,"@").replace(/&num;/g,"#").replace(/&dollar;/g,"$").replace(/&percnt;/g,"%").replace(/&Hat;/g,"^").replace(/&ast;/g,"*").replace(/&lpar;/g,"(").replace(/&rpar;/g,")").replace(/&hyphen;/g,"-").replace(/&lowbar;/g,"_").replace(/&plus;/g,"+").replace(/&equals;/g,"=").replace(/&lbrace;/g,"{").replace(/&rbrace;/g,"}").replace(/&rbrack;/g,"]").replace(/&lbrack;/g,"[").replace(/&colon;/g,":").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&comma;/g,",").replace(/&lt;/g,"<").replace(/&period;/g,".").replace(/&gt;/g,">").replace(/&quest;/g,"?").replace(/&sol;/g,"/").replace(/&vert;/g,"|")},sanatizePercent=function(a){var b=String(a);return-1==b.indexOf(".")?b>=1&&b<100?b/=100:b="."+b:b>1&&b<10?b/=100:b<1?(b=b.replace(".",""),b="."+b,b*=10):(b=b.replace(".",""),b="."+b),b=parseFloat(b),Math.round(1e4*b)/1e4}}]).filter("dateRange",function(){return function(a,b,c,d){return a.filter(function(a){return!moment(a[b],"YYYY-MM-DD").isBefore(moment(c))&&!moment(a[b],"YYYY-MM-DD").isAfter(moment(d))})}})}(window,window.angular),function(a,b,c){b.module("app").controller("loginCtrl",["$scope","$state","$http","userSvc",function(b,c,d,e){b.logUserIn=function(a){d.post("/api/user/login",a).then(function(a){e.token=a.data.token,e.user=a.data.user.username,localStorage.setItem("token",JSON.stringify(e.token)),localStorage.setItem("user",JSON.stringify(e.user)),"Admin"!==a.data.user.role&&"Editor"!==a.data.user.role||(e.role=a.data.user.role,localStorage.setItem("role",JSON.stringify(e.role))),c.go("home")},function(a){if(console.error(a),Array.isArray(a.data)){$("#password_Error").empty(),$("#login_error").empty();for(var b=0;b<a.data.length;b++)$("#login_error").append('<p class="alert alert-danger">'+a.data[b]+"<p>")}else $("#password_Error").empty(),$("#login_error").empty(),$("#login_error").append('<p class="alert alert-danger">'+a.data+"<p>")})},b.passwordRecovery=function(){c.go("password_recovery")},b.sent=!1,b.forgotPassword=function(c){b.email=c.email,c={to:c.email,urlBase:a.location.origin},console.log(a.location.origin),d.post("api/user/password_request",c).then(function(a){b.sent=!0},function(a){console.log(a),b.sent=!0})}}])}(window,window.angular),function(a,b,c){b.module("app").controller("manageUserCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.allRegions=[],a.roles=["User","Editor","Admin"],a.approveUser=function(a){a.login_attempts=0,a.last_login_attempt=Date.now(),console.log(a),c.post("/secure-api/user/approve_user",a,e).then(function(a){console.log("User Apprvoed"),b.reload()},function(a){console.error(a)})},a.submitUser=function(a){c.put("/secure-api/user/update_user",a,e).then(function(a){console.log("User Updated"),b.reload()},function(a){console.log(a)})},a.deleteUnapprovedUser=function(a){confirm("Are you sure you want to deny this User?")&&(request="/secure-api/user/delete_unapproved_user/?"+a,c.delete(request,e).then(function(a){console.log("User Removed"),b.reload()},function(a){console.log(a)}))},a.deleteUser=function(a){confirm("Are you sure you want to delete this User?")&&a.username!=d.user?(request="/secure-api/user/delete_user/?"+a.id,c.delete(request,e).then(function(a){console.log("User Removed"),b.reload()},function(a){console.log(a)})):console.log("You cant delete yourself from this screen.")},c.get("/secure-api/user/get_users",e).then(function(b){a.allUsers=b.data.data},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")}),c.get("/secure-api/user/get_unapproved_users",e).then(function(b){a.allUnapprovedUsers=b.data.data},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("profileCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){var e={headers:{"auth-token":d.token}};a.user={},a.submitProfile=function(a){c.put("/secure-api/user/update_profile",a,e).then(function(a){console.log("User Updated"),b.reload()},function(a){console.log(a)})},a.deleteProfile=function(b){confirm("Are you sure you want to delete your account? This CANNOT be undone.")&&a.user_id===b&&(request="/secure-api/user/delete_profile/?"+b,c.delete(request,e).then(function(b){a.logout(),console.log("Profile Deleted")},function(a){console.log(a)}))},a.changePassword=function(a){a.new_password===a.confirm_password?c.put("/secure-api/user/change_password",a,e).then(function(a){console.log("User Updated"),b.reload()},function(a){console.log(a),$("#password_Error").empty();for(var b=0;b<a.data.length;b++)$("#password_Error").append('<p class="alert alert-danger">'+a.data[b]+"<p>")}):console.log("Passwords Do Not Match")},c.get("/secure-api/user/get_user?"+d.user,e).then(function(b){a.user=b.data.data[0],a.user_id=a.user.id},function(c){console.log(c),"Invalid Token"===c.data?a.logout():b.go("home")})}])}(window,window.angular),function(a,b,c){b.module("app").controller("registerCtrl",["$scope","$state","$http","userSvc",function(a,b,c,d){a.passLength=!1,a.special=!1,a.upperCase=!1,a.lowerCase=!1,a.number=!1,a.requirements=!1,a.passMatch=!1,a.formChange=function(b){var c=/[~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/,d=/[A-Z]/,e=/[a-z]/,f=/\d/;b.user_password.length>13?a.passLength=!0:b.user_password.length<14&&(a.passLength=!1),c.test(b.user_password)?a.special=!0:a.special=!1,d.test(b.user_password)?a.upperCase=!0:a.upperCase=!1,e.test(b.user_password)?a.lowerCase=!0:a.lowerCase=!1,f.test(b.user_password)?a.number=!0:a.number=!1,b.user_password===b.password_check?a.passMatch=!0:a.passMatch=!1,!0===a.passMatch&&!0===a.passLength&&!0===a.special&&!0===a.upperCase&&!0===a.lowerCase&&!0===a.number?a.requirements=!0:a.requirements=!1},a.createUser=function(d){!0===a.requirements?($("#password_Error").empty(),$("#login_error").empty(),d.user_password===d.password_check?c.post("/api/user/create",d).then(function(a){
$("#password_Error").empty(),$("#login_error").empty(),b.go("home")},function(a){if(console.error(a),Array.isArray(a.data)){$("#password_Error").empty(),$("#login_error").empty();for(var b=0;b<a.data.length;b++)$("#password_Error").append('<p class="alert alert-danger">'+a.data[b]+"<p>")}else $("#password_Error").empty(),$("#login_error").empty(),$("#password_Error").append('<p class="alert alert-danger">'+a.data+"<p>")}):($("#password_Error").empty(),$("#password_Error").append('<p class="alert alert-danger"> Passwords do not match, please make sure that they are the same <p>'))):($("#password_Error").empty(),$("#password_Error").append('<p class="alert alert-danger"> Please make sure you\'re password meets the requirements<p>'))}}])}(window,window.angular),function(a,b,c){b.module("app").controller("pswdCtrl",["$scope","$state","$http","$stateParams","userSvc",function(a,b,c,d,e){a.state=b.current,a.params=d,a.resetCode=a.params.resetCode,a.user_id=a.params.userID,a.passLength=!1,a.special=!1,a.upperCase=!1,a.lowerCase=!1,a.number=!1,a.requirements=!1,a.passMatch=!1,a.formChange=function(b){var c=/[~`!#$%\^&*+=\-\[\]\\';,\/{}|\\":<>\?]/,d=/[A-Z]/,e=/[a-z]/,f=/\d/;b.enter.length>13?a.passLength=!0:b.enter.length<14&&(a.passLength=!1),c.test(b.enter)?a.special=!0:a.special=!1,d.test(b.enter)?a.upperCase=!0:a.upperCase=!1,e.test(b.enter)?a.lowerCase=!0:a.lowerCase=!1,f.test(b.enter)?a.number=!0:a.number=!1,b.enter===b.check?a.passMatch=!0:a.passMatch=!1,!0===a.passMatch&&!0===a.passLength&&!0===a.special&&!0===a.upperCase&&!0===a.lowerCase&&!0===a.number?a.requirements=!0:a.requirements=!1},a.submitPassword=function(d){!0===a.requirements?($("#message").empty(),void 0===d.check||void 0===d.enter?$("#message").append('<br><p class="alert alert-danger"> Please enter a password. </p>'):d.check!=d.enter?$("#message").append('<br><p class="alert alert-danger"> The entered passwords do not match. </p>'):d.check===d.enter&&(d.reset_code=a.resetCode,d.user_id=a.user_id,c.post("api/user/reset_password",d),b.go("login"))):$("#password_Error").append('<p class="alert alert-danger"> Please make sure you\'re password meets the requirements<p>')}}])}(window,window.angular);